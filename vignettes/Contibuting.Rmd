---
title: "Contributing to EpiForsk"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Contributing to EpiForsk}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(EpiForsk)
```

This vignette describes our recommeded workflow for contributing your work to
the EpiForsk package, using the [usethis](https://usethis.r-lib.org/index.html)
package.

## Overview
There are two steps you must do the first time you want to contribute, or if you
have changed computer:

a. Generate a personal access token (PAT) to allow R to access the GitHub API.
b. fork-and-clone the EpiForsk repository to your work computer.

The next steps descripe the workflow from begining work on a new contribution
to that work being merged into the source repository:

1. Create a new feature branch  for developing your functions, vignettes, and other contributions.
2. Commit your work to your local feature branch with a description of its contents.
3. When your contribution is ready, initiate a pull request to the upstream git repository.
4. A package maintainer will look at your pull request, and may request changes. Resolve these issues and push your updates. 
5. When all issues are resolved, your work will be merged to the main branch. You can now switch back to the default branch, pull upstream changes, and delete the feature branch.

## Managing Git Credentials
To get your git credentials set up, follow these steps:

1. Log into github.
2. Run `usethis::create_github_token()`. Alternatively, go to [github](https://github.com/settings/tokens), click on "generate new token", then fill out the form.
3. Run `gitcreds::gitcreds_set()` to register the token in the local Git credential store.
4. Remember to regenerate and restore your PAT on the schedule set in step 2. The default period recommended by github is 1 month.

For more details, you can read the usethis vignette [git-credentials](https://usethis.r-lib.org/articles/git-credentials.html).

## Clone the EpiForsk repository
To protect the source repository, you must copy it to your own github account, 
and then clone it to get a local copy. This is accomplished with
```{r, eval=FALSE}
usethis::create_from_github("https://github.com/Laksafoss/EpiForsk", fork = TRUE)
```

## Contribution workflow
When working on a contribution, do so on a seperate feature branch. It is best practice to never make commits to the default branch branch of a fork. To create your feature branch, run
```{r, eval=FALSE}
usethis::pr_init("branch_name")
```

When your done working on your contribution, commit it to your local clone. 
This can be done using the git tab in R-studio. Remember to stage any file you 
want to include in your commit and write a descriptive commit message. It is ok
to make multiple commits before initiating a 
[pull requests](https://usethis.r-lib.org/articles/pr-functions.html). 
To do this, run
```{r, eval=FALSE}
usethis::pr_push()
```
This will open a webpage that lets you initiate the PR. take note of the PR 
number, as this is used to reference the PR.

At this point, a package maintainer will look at your PR, and they will either
accept it or request changes. If changes are requested, work on resolving the
issues. Any changes you make must be commited to your local branch, then pushed
upstream using `usethis::pr_push()`. If changes have been comitted by the 
reviewer, you can pull these using `usethis::pr_pull()`. 

When all issues are resolved, the PR will be accepted and merged into the source
repository. At this point, you should run 
```{r, eval=FALSE}
usethis::pr_finish("PR number")
```
This will switch you back to the default branch, pull changes from the source
repository and delete the local feature branch.

## Additional

Function or vignette
stricter requirements 
[Hadley's R package book](https://r-pkgs.org/)
